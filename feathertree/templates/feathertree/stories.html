{% extends "feathertree/base.html" %}

{% block head %}
<title>Feathertree</title>
<meta name="description" content="Welcome to Feathertree â€” a collaborative storytelling platform where authors build branching tales together.">
{% endblock head %}

{% block body %}
{% include "feathertree/_header.html" %}

<main class="container content">
  <section class="story-list-section">
    <header class="story-list-header">
      <h3>Recently Updated Stories</h3>
    </header>
  <article class="stack">
      {% if stories_page and stories_page.object_list %}
        <ul class="story-list">
          {% for story in stories_page %}
            {% include "feathertree/_story_card.html" with story=story is_collapsible=False %}
          {% endfor %}
        </ul>

        {# --- Pagination controls --- #}
        {% if stories_page.has_other_pages %}
          <nav class="pagination" aria-label="Story list pagination">
            {% if stories_page.has_previous %}
              <a class="page-link" href="?page={{ stories_page.previous_page_number }}">&laquo; Previous</a>
            {% else %}
              <span class="page-link disabled">&laquo; Previous</span>
            {% endif %}

            <span class="page-info">
              Page {{ stories_page.number }} of {{ stories_page.paginator.num_pages }}
            </span>

            {% if stories_page.has_next %}
              <a class="page-link" href="?page={{ stories_page.next_page_number }}">Next &raquo;</a>
            {% else %}
              <span class="page-link disabled">Next &raquo;</span>
            {% endif %}
          </nav>
        {% endif %}
      {% else %}
        <p><em>No stories have been published yet.</em>
          {% if user.is_authenticated %}
            Why not <a href="{% url 'feathertree:story_create' %}">create the first one</a>?
          {% endif %}
        </p>
      {% endif %}
    </section>
  </article>
  {% if user.is_authenticated %}
  <section class="welcome-section">
    <div class="button-group">
      <a class="btn primary" href="{% url 'feathertree:story_create' %}">Create a New Story</a>
    </div>
  </section>
  {% endif %}
</main>
{% endblock body %}
